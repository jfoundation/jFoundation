(function(e,t,n,r){"use strict";Foundation.libs.clearing={name:"clearing",version:"5.1.0",settings:{templates:{viewing:'<a href="#" class="clearing-close">&times;</a><div class="visible-img" style="display: none"><div class="clearing-touch-label"></div><img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D" alt="" /><p class="clearing-caption"></p><a href="#" class="clearing-main-prev"><span></span></a><a href="#" class="clearing-main-next"><span></span></a></div>'},close_selectors:".clearing-close",touch_label:"&larr;&nbsp;Swipe to Advance&nbsp;&rarr;",init:!1,locked:!1},init:function(e,t,n){var r=this;Foundation.inherit(this,"throttle image_loaded");this.bindings(t,n);r.S(this.scope).is("["+this.attr_name()+"]")?this.assemble(r.S("li",this.scope)):r.S("["+this.attr_name()+"]",this.scope).each(function(){r.assemble(r.S("li",this))})},events:function(e){var n=this,r=n.S;r(this.scope).off(".clearing").on("click.fndtn.clearing","ul["+this.attr_name()+"] li",function(e,t,i){var t=t||r(this),i=i||t,s=t.next("li"),o=t.closest("["+n.attr_name()+"]").data(n.attr_name(!0)+"-init"),u=r(e.target);e.preventDefault();if(!o){n.init();o=t.closest("["+n.attr_name()+"]").data(n.attr_name(!0)+"-init")}if(i.hasClass("visible")&&t[0]===i[0]&&s.length>0&&n.is_open(t)){i=s;u=r("img",i)}n.open(u,t,i);n.update_paddles(i)}).on("click.fndtn.clearing",".clearing-main-next",function(e){n.nav(e,"next")}).on("click.fndtn.clearing",".clearing-main-prev",function(e){n.nav(e,"prev")}).on("click.fndtn.clearing",this.settings.close_selectors,function(e){Foundation.libs.clearing.close(e,this)}).on("keydown.fndtn.clearing",function(e){n.keydown(e)});r(t).off(".clearing").on("resize.fndtn.clearing",function(){n.resize()});this.swipe_events(e)},swipe_events:function(e){var t=this,n=t.S;n(this.scope).on("touchstart.fndtn.clearing",".visible-img",function(e){e.touches||(e=e.originalEvent);var t={start_page_x:e.touches[0].pageX,start_page_y:e.touches[0].pageY,start_time:(new Date).getTime(),delta_x:0,is_scrolling:r};n(this).data("swipe-transition",t);e.stopPropagation()}).on("touchmove.fndtn.clearing",".visible-img",function(e){e.touches||(e=e.originalEvent);if(e.touches.length>1||e.scale&&e.scale!==1)return;var r=n(this).data("swipe-transition");typeof r=="undefined"&&(r={});r.delta_x=e.touches[0].pageX-r.start_page_x;typeof r.is_scrolling=="undefined"&&(r.is_scrolling=!!(r.is_scrolling||Math.abs(r.delta_x)<Math.abs(e.touches[0].pageY-r.start_page_y)));if(!r.is_scrolling&&!r.active){e.preventDefault();var i=r.delta_x<0?"next":"prev";r.active=!0;t.nav(e,i)}}).on("touchend.fndtn.clearing",".visible-img",function(e){n(this).data("swipe-transition",{});e.stopPropagation()})},assemble:function(t){var n=t.parent();if(n.parent().hasClass("carousel"))return;n.after('<div id="foundationClearingHolder"></div>');var r=this.S("#foundationClearingHolder"),i=n.data(this.attr_name(!0)+"-init"),s=n.detach(),o={grid:'<div class="carousel">'+s[0].outerHTML+"</div>",viewing:i.templates.viewing},u='<div class="clearing-assembled"><div>'+o.viewing+o.grid+"</div></div>",a=this.settings.touch_label;Modernizr.touch&&(u=e(u).find(".clearing-touch-label").html(a).end());r.after(u).remove()},open:function(e,t,n){var r=this,i=n.closest(".clearing-assembled"),s=r.S("div",i).first(),o=r.S(".visible-img",s),u=r.S("img",o).not(e),a=r.S(".clearing-touch-label",s);if(!this.locked()){u.attr("src",this.load(e)).css("visibility","hidden");this.image_loaded(u,function(){u.css("visibility","visible");i.addClass("clearing-blackout");s.addClass("clearing-container");o.show();this.fix_height(n).caption(r.S(".clearing-caption",o),e).center_and_label(u,a).shift(t,n,function(){n.siblings().removeClass("visible");n.addClass("visible")})}.bind(this))}},close:function(t,n){t.preventDefault();var r=function(e){return/blackout/.test(e.selector)?e:e.closest(".clearing-blackout")}(e(n)),i,s;if(n===t.target&&r){i=e("div",r).first();s=e(".visible-img",i);this.settings.prev_index=0;e("ul["+this.attr_name()+"]",r).attr("style","").closest(".clearing-blackout").removeClass("clearing-blackout");i.removeClass("clearing-container");s.hide()}return!1},is_open:function(e){return e.parent().prop("style").length>0},keydown:function(t){var n=e("ul["+this.attr_name()+"]",".clearing-blackout"),r=this.rtl?37:39,i=this.rtl?39:37,s=27;t.which===r&&this.go(n,"next");t.which===i&&this.go(n,"prev");t.which===s&&this.S("a.clearing-close").trigger("click")},nav:function(t,n){var r=e("ul["+this.attr_name()+"]",".clearing-blackout");t.preventDefault();this.go(r,n)},resize:function(){var t=e("img",".clearing-blackout .visible-img"),n=e(".clearing-touch-label",".clearing-blackout");t.length&&this.center_and_label(t,n)},fix_height:function(e){var t=e.parent().children(),n=this;t.each(function(){var e=n.S(this),t=e.find("img");e.height()>t.outerHeight()&&e.addClass("fix-height")}).closest("ul").width(t.length*100+"%");return this},update_paddles:function(e){var t=e.closest(".carousel").siblings(".visible-img");e.next().length>0?this.S(".clearing-main-next",t).removeClass("disabled"):this.S(".clearing-main-next",t).addClass("disabled");e.prev().length>0?this.S(".clearing-main-prev",t).removeClass("disabled"):this.S(".clearing-main-prev",t).addClass("disabled")},center_and_label:function(e,t){if(!this.rtl){e.css({marginLeft:-(e.outerWidth()/2),marginTop:-(e.outerHeight()/2)});t.css({marginLeft:-(t.outerWidth()/2),marginTop:-(e.outerHeight()/2)-t.outerHeight()-10})}else{e.css({marginRight:-(e.outerWidth()/2),marginTop:-(e.outerHeight()/2),left:"auto",right:"50%"});t.css({marginRight:-(t.outerWidth()/2),marginTop:-(e.outerHeight()/2)-t.outerHeight()-10,left:"auto",right:"50%"})}return this},load:function(e){if(e[0].nodeName==="A")var t=e.attr("href");else var t=e.parent().attr("href");this.preload(e);return t?t:e.attr("src")},preload:function(e){this.img(e.closest("li").next()).img(e.closest("li").prev())},img:function(e){if(e.length){var t=new Image,n=this.S("a",e);n.length?t.src=n.attr("href"):t.src=this.S("img",e).attr("src")}return this},caption:function(e,t){var n=t.data("caption");n?e.html(n).show():e.text("").hide();return this},go:function(e,t){var n=this.S(".visible",e),r=n[t]();r.length&&this.S("img",r).trigger("click",[n,r])},shift:function(e,t,n){var r=t.parent(),i=this.settings.prev_index||t.index(),s=this.direction(r,e,t),o=this.rtl?"right":"left",u=parseInt(r.css("left"),10),a=t.outerWidth(),f,l={};if(t.index()!==i&&!/skip/.test(s)){if(/left/.test(s)){this.lock();l[o]=u+a;r.animate(l,300,this.unlock())}else if(/right/.test(s)){this.lock();l[o]=u-a;r.animate(l,300,this.unlock())}}else if(/skip/.test(s)){f=t.index()-this.settings.up_count;this.lock();if(f>0){l[o]=-(f*a);r.animate(l,300,this.unlock())}else{l[o]=0;r.animate(l,300,this.unlock())}}n()},direction:function(e,t,n){var r=this.S("li",e),i=r.outerWidth()+r.outerWidth()/4,s=Math.floor(this.S(".clearing-container").outerWidth()/i)-1,o=r.index(n),u;this.settings.up_count=s;this.adjacent(this.settings.prev_index,o)?o>s&&o>this.settings.prev_index?u="right":o>s-1&&o<=this.settings.prev_index?u="left":u=!1:u="skip";this.settings.prev_index=o;return u},adjacent:function(e,t){for(var n=t+1;n>=t-1;n--)if(n===e)return!0;return!1},lock:function(){this.settings.locked=!0},unlock:function(){this.settings.locked=!1},locked:function(){return this.settings.locked},off:function(){this.S(this.scope).off(".fndtn.clearing");this.S(t).off(".fndtn.clearing")},reflow:function(){this.init()}}})(jQuery,this,this.document);